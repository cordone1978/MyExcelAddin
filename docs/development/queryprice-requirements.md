# 查询价格（QueryPrice）需求说明

更新时间：2026-02-13

## 1. 触发方式
- 用户在“查询价格”窗口中，双击任意一条查询结果。
- 双击后由父窗口（Taskpane）执行选区校验与写入。

## 2. 选区校验规则
- 当前工作表是 `报价配置表`：
  - 必须选中 `C` 列；否则弹出警告弹窗，不写入。
- 当前工作表是 `易损件表`（或 `易损表`）：
  - 不强制要求 `C` 列；按当前选中行写入。
- 其他工作表：
  - 弹出警告弹窗，不写入。
- 表头行（第 1 行）：
  - 弹出警告弹窗，不写入。

## 3. 写入规则（对齐 VBA: frmShowPriceForm + FillCellsWithData）
写入基准列固定为 `C` 列（按当前选中行）。

- `D列 = desc`
- `E列 = type`
- `F列 = material`
- `G列 = brand`
- `I列 = unit`
- `H列` 若为空则写入 `1`
- 价格列：
  - 在 `易损件表/易损表` 写入 `L列`
  - 在 `报价配置表` 写入 `N列`

说明：不覆盖 `C` 列原值（组件名称）。

## 4. 交互反馈
- 选区不合法时：
  - 查询窗口内显示遮罩式警告弹窗（不使用 `alert`）。
- 写入成功时：
  - 关闭查询窗口；
  - 光标定位到目标行 `C` 列。

## 5. 实现文件
- `src/taskpane/querypriceController.ts`：选区校验、写入调度。
- `src/dialog/queryprice.ts`：查询与双击事件、警告弹窗展示。
- `src/dialog/queryprice.html`：页面结构与警告弹窗容器。
- `src/dialog/queryprice.css`：页面样式与警告弹窗样式。
